<!DOCTYPE html>
<html>

<head>
  <title>Haflop - Poker</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
  
  <style>
    /* Debugging styles */
    .debug-panel {
      position: fixed;
      bottom: 60px;
      right: 10px;
      background: rgba(0,0,0,0.8);
      border-radius: 5px;
      padding: 10px;
      color: white;
      font-family: monospace;
      font-size: 12px;
      width: 300px;
      max-height: 200px;
      overflow-y: auto;
      z-index: 9999;
      display: none;
    }
    
    .debug-entry {
      border-bottom: 1px solid rgba(255,255,255,0.2);
      padding: 5px 0;
    }
    
    .debug-error {
      color: #ff5252;
    }
    
    .debug-success {
      color: #4BB543;
    }
    
    .debug-toggle {
      position: fixed;
      bottom: 10px;
      left: 10px;
      background: rgba(255,0,0,0.3);
      border: none;
      color: white;
      padding: 8px 12px;
      border-radius: 5px;
      cursor: pointer;
      z-index: 9999;
    }
  </style>
</head>

<body>
  <div class="back button">
    <span class="material-symbols-outlined" style="margin-top: 1px;">
      arrow_back
    </span>
  </div>

  <div class="main-container">
    <div class="content">
      <div class="table">
        <div class="pot">
          <span class="pot-number">0</span>
          <span class="material-symbols-outlined" style="font-size: 30px; margin-top: 2.5px; opacity: .8;">
            poker_chip
          </span>
        </div>

        <!-- Community cards container -->
        <div class="table-cards">
          <div class="table-card hidden">?</div>
          <div class="table-card hidden">?</div>
          <div class="table-card hidden">?</div>
          <div class="table-card hidden">?</div>
          <div class="table-card hidden">?</div>
        </div>

        <!-- Game status display -->
        <div class="game-status">Waiting for players...</div>

        <div class="users">
          <!-- Current player will be added dynamically -->
        </div>

        <!-- Other players - these will be populated dynamically -->
        <div class="other-users">
          <!-- Seat positions will be filled dynamically -->
        </div>
      </div>

      <!-- Player action bar - new feature -->
      <div class="player-actions">
        <div class="action-buttons">
          <button id="fold-btn" class="action-btn fold-btn disabled" disabled>Fold</button>
          <button id="check-btn" class="action-btn check-btn disabled" disabled>Check</button>
          <div class="bet-controls">
            <div class="bet-amount-container">
              <input type="number" id="bet-amount" min="10" max="1000" value="10" disabled>
              <div class="bet-amount-controls">
                <button id="bet-increase" class="bet-control-btn">+</button>
                <button id="bet-decrease" class="bet-control-btn">-</button>
              </div>
            </div>
            <button id="bet-btn" class="action-btn bet-btn disabled" disabled>Bet</button>
            <button id="raise-btn" class="action-btn raise-btn disabled" disabled>Raise</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Chat system -->
    <div class="chat-container">
      <div class="chat-header">
        <h3>Table Chat</h3>
      </div>
      <div class="chat-messages" id="chat-messages">
        <!-- Messages will be appended here -->
      </div>
      <div class="chat-input-container">
        <input type="text" id="chat-input" placeholder="Type a message...">
        <button id="send-message-btn">
          <span class="material-symbols-outlined">send</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Debug panel -->
  <div class="debug-panel" id="debug-panel"></div>
  <button class="debug-toggle" id="debug-toggle">üêû Show Debug</button>

  <!-- Load socket.io client -->
  <script src="/socket.io/socket.io.js"></script>
  
  <!-- Debugging script -->
  <script>
    // Set up global error handler
    window.addEventListener('error', function(e) {
      console.error('Global error:', e.message);
      addDebugEntry('ERROR: ' + e.message, true);
    });
    
    // Debug panel functionality
    const debugPanel = document.getElementById('debug-panel');
    const debugToggle = document.getElementById('debug-toggle');
    let debugVisible = false;
    
    debugToggle.addEventListener('click', function() {
      debugVisible = !debugVisible;
      debugPanel.style.display = debugVisible ? 'block' : 'none';
      debugToggle.textContent = debugVisible ? 'üêû Hide Debug' : 'üêû Show Debug';
    });
    
    function addDebugEntry(message, isError = false) {
      const entry = document.createElement('div');
      entry.className = 'debug-entry' + (isError ? ' debug-error' : '');
      entry.textContent = message;
      debugPanel.appendChild(entry);
      debugPanel.scrollTop = debugPanel.scrollHeight;
    }
    
    // Check if Socket.io is loaded
    setTimeout(function() {
      if (typeof io === 'undefined') {
        console.error('Socket.io not loaded after 2 seconds');
        addDebugEntry('Socket.io not loaded!', true);
        alert('Socket.io failed to load. The game will not function correctly.');
      } else {
        console.log('Socket.io loaded successfully');
        addDebugEntry('Socket.io loaded ‚úì');
      }
    }, 2000);
  </script>
  
  <!-- Load our custom socket client -->
  <script src="socket-client.js"></script>
  
  <!-- Load game logic -->
  <script src="game.js"></script>

</body>

</html>